<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>is-vTRN â€” Romain Abdel-Aal</title>
  <link rel="stylesheet" href="/styles/main.css">
</head>

<body>
  <div class="bg-gradient"></div>
  <div class="bg-noise"></div>

  <header class="paper-header">
    <div class="container">
      <a href="/" aria-label="Go to homepage">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
          <path d="M19 12H5M12 19l-7-7 7-7" />
        </svg>
        Back
      </a>
      <nav style="display: flex; align-items: center; gap: var(--space-md);">
        <button onclick="window.print()" class="icon-button" title="Print Paper"
          style="background:none; border:none; color:inherit; cursor:pointer;">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
            <path d="M6 9V2h12v7M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2" />
            <path d="M6 14h12v8H6z" />
          </svg>
        </button>
        <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">ðŸŒ™</button>
      </nav>
    </div>
    <div class="paper-progress-container">
      <div id="paper-progress-bar"></div>
    </div>
  </header>

  <main class="paper-main">
    <div class="paper-sheet">
      <div class="paper-verification">
        <div class="verification-dot"></div>
        <span class="verification-text">Verified Architecture â€¢ IS-VTRN-PROTO</span>
      </div>

      <div class="paper-metadata">
        <div class="paper-metadata-grid">
          <div class="metadata-item">
            <span class="metadata-label">Author</span>
            <span class="metadata-value">Romain Abdel-Aal</span>
          </div>
          <div class="metadata-item">
            <span class="metadata-label">Date</span>
            <span class="metadata-value">2025</span>
          </div>
          <div class="metadata-item">
            <span class="metadata-label">Category</span>
            <span class="metadata-value">Temporal Networks / Inertial SSR</span>
          </div>
          <div class="metadata-item">
            <span class="metadata-label">Status</span>
            <span class="metadata-value" style="color: #4facfe;">Prototype Phase</span>
          </div>
        </div>
      </div>

      <div id="content">Loading paper content...</div>
    </div>
  </main>

  <script src="/scripts/futuristic-charts.js" defer></script>
  <script src="/scripts/theme.js" defer></script>
  <script src="/scripts/playgrounds.js" defer></script>
  <script>
    function loadScript(src) {
      return new Promise((res, rej) => {
        const s = document.createElement('script');
        s.src = src;
        s.onload = res;
        s.onerror = () => rej(new Error('Failed to load ' + src));
        document.head.appendChild(s);
      });
    }
    function ensureMarked() {
      if (window.marked) return Promise.resolve();
      return loadScript('/scripts/marked.min.js').then(() => {
        if (window.marked) return;
        return loadScript('https://cdn.jsdelivr.net/npm/marked/marked.min.js');
      });
    }

    fetch('The Inertial-Speculative Temporal Residue Network (is-vTRN)_ A Computationally Superior Post-Transformer Architecture.md')
      .then(r => r.text())
      .then(md => {
        const sanitized = md.replace(/!\[[^\]]*\]\([^\)]+\)/g, () => '\n<div data-fchart></div>\n');
        return ensureMarked().then(() => ({ sanitized }));
      })
      .then(({ sanitized }) => {
        const html = (marked.parse ? marked.parse(sanitized) : marked(sanitized));
        document.getElementById('content').innerHTML = `
          <div id="is-vtrn-playground"></div>
          <hr style="margin: var(--space-2xl) 0; border: 0; border-top: 1px solid var(--border-subtle);">
          ${html}
        `;

        // Promote first heading to H1
        const firstHeading = document.querySelector('#content h3, #content h2, #content h1');
        if (firstHeading) {
          const h1 = document.createElement('h1');
          h1.innerHTML = firstHeading.innerHTML;
          firstHeading.parentNode.replaceChild(h1, firstHeading);
        }

        if (window.renderFuturisticCharts) window.renderFuturisticCharts(document.getElementById('content'));
        if (window.initPlayground) window.initPlayground('is-vtrn', 'is-vtrn-playground');
        window.dispatchEvent(new Event('scroll'));
      })
      .catch(err => { console.error('Failed to load paper:', err); document.getElementById('content').textContent = 'Failed to load paper.'; });

    window.addEventListener('scroll', () => {
      const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      const scrolled = (winScroll / height) * 100;
      const bar = document.getElementById('paper-progress-bar');
      if (bar) bar.style.width = scrolled + '%';
    });
  </script>
</body>

</html>